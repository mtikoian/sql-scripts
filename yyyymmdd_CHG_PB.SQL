

 SELECT
  NVL(CLARITY_TDL_TRAN.bill_area_id,620004096) AS "Level1Code"
, CLARITY_TDL_TRAN.HSP_ACCOUNT_ID || '-' || CLARITY_TDL_TRAN.TX_ID AS "Account_Number"
, To_Char(CLARITY_TDL_TRAN.POST_DATE,'MM/DD/YYYY') AS Post_Date
, SUBSTR(CLARITY_EAP.PROC_CODE, 1, 9) AS HCPCS_CPT
, CLARITY_TDL_TRAN.MODIFIER_ONE AS Modifier_1
, CLARITY_TDL_TRAN.MODIFIER_TWO AS Modifier_2
, CLARITY_TDL_TRAN.MODIFIER_THREE AS Modifier_3
, CLARITY_TDL_TRAN.MODIFIER_FOUR AS MODIFIER_4
, CLARITY_TDL_TRAN.RVU_WORK AS Provider_RVU
, CLARITY_POS.POS_TYPE_C AS Place_of_Service
, '' AS Carrier_Number
, '' AS Locality_Number
, CLARITY_EAP.UB_REV_CODE_ID AS REVENUE_CODE
, RPROV.NPI AS REFERING_PROV_NPI
, PPROV.NPI AS PERFORMING_PROV_NPI
, BPROV.NPI AS BILLING_PROV_NPI
, '' AS ATTENDING_PROV_NPI
, CLARITY_TDL_TRAN.PROCEDURE_QUANTITY AS Days_Units
, CLARITY_TDL_TRAN.AMOUNT AS Charge_Amt
, CLARITY_TDL_TRAN.AMOUNT AS Total_Charge_Amt

 FROM CLARITY.CLARITY_TDL_TRAN CLARITY_TDL_TRAN
 LEFT JOIN arpb_tx_moderate            TMOD ON CLARITY_TDL_TRAN.TX_ID       = TMOD.TX_ID
 LEFT JOIN CLARITY.CLARITY_POS CLARITY_POS  ON CLARITY_TDL_TRAN.POS_ID      = CLARITY_POS.POS_ID
 LEFT JOIN CLARITY.CLARITY_EAP CLARITY_EAP  ON CLARITY_TDL_TRAN.PROC_ID     = CLARITY_EAP.PROC_ID
 LEFT JOIN CLARITY.REFERRAL REFERRAL     	  ON CLARITY_TDL_TRAN.REFERRAL_ID = REFERRAL.REFERRAL_ID
 LEFT JOIN CLARITY_SER_2             PPROV  ON CLARITY_TDL_TRAN.PERFORMING_PROV_ID = PPROV.PROV_ID
 LEFT JOIN CLARITY_SER_2             BPROV  ON CLARITY_TDL_TRAN.BILLING_PROVIDER_ID = BPROV.PROV_ID
 LEFT JOIN CLARITY_SER_2             RPROV  ON TMOD.REFERRAL_PROV_ID = RPROV.PROV_ID
 WHERE  CLARITY_TDL_TRAN.POST_DATE = Trunc(SYSDATE)-1
    AND CLARITY_TDL_TRAN.DETAIL_TYPE IN (1,10)
;
