--TSM 
-- IN PROCESS  
--NEEDS VERIFICATION!


SELECT DISTINCT 
                         dbo.PATIENT.PAT_ID AS epic_pt_id, 
						 dbo.PATIENT.PAT_MRN_ID,
						 dbo.PATIENT.PAT_NAME, 
						 dbo.PATIENT.BIRTH_DATE, 
						 dbo.PATIENT.ADD_LINE_1, 
						 dbo.PATIENT.ADD_LINE_2, 
                         dbo.PATIENT.CITY, dbo.PATIENT.ZIP, 
						 dbo.PAT_ACCT_CVG.SERV_AREA_ID, 
						 dbo.PAT_ACCT_CVG.ACCOUNT_ID AS EPIC_ACCT_ID, 
						 dbo.CLARITY_EPM.PAYOR_NAME, 
                         dbo.CLARITY_EPM.PAYOR_ID AS EPIC_PAYOR_ID, 
						 dbo.V_COVERAGE_PAYOR_PLAN.PAYOR_NAME, 
						 dbo.COVERAGE.PLAN_ID, 
						 dbo.COVERAGE.SUBSCR_NUM, 
                         dbo.COVERAGE.SUBSCR_NAME, 
						 dbo.COVERAGE.GROUP_NUM, 
						 mem_eff_from_date,
						 mem_eff_to_date,
                         dbo.V_COVERAGE_PAYOR_PLAN.BENEFIT_PLAN_NAME, 
						 dbo.PAT_ACCT_CVG.ACCOUNT_ACTIVE_YN
FROM            dbo.CLARITY_EPM RIGHT OUTER JOIN
                         dbo.V_COVERAGE_PAYOR_PLAN RIGHT OUTER JOIN
                         dbo.COVERAGE ON dbo.V_COVERAGE_PAYOR_PLAN.COVERAGE_ID = dbo.COVERAGE.COVERAGE_ID ON 
                         dbo.CLARITY_EPM.PAYOR_ID = dbo.COVERAGE.PAYOR_ID RIGHT OUTER JOIN
                         dbo.ACCT_COVERAGE RIGHT OUTER JOIN
                         dbo.PATIENT INNER JOIN
                         dbo.PAT_ACCT_CVG ON dbo.PATIENT.PAT_ID = dbo.PAT_ACCT_CVG.PAT_ID ON dbo.ACCT_COVERAGE.COVERAGE_ID = dbo.PAT_ACCT_CVG.COVERAGE_ID AND 
                         dbo.ACCT_COVERAGE.ACCOUNT_ID = dbo.PAT_ACCT_CVG.ACCOUNT_ID ON dbo.COVERAGE.COVERAGE_ID = dbo.ACCT_COVERAGE.COVERAGE_ID
						 left join dbo.coverage_mem_list mem on mem.coverage_id = coverage.coverage_id
WHERE mem_eff_from_date = (CONVERT(DATETIME, '2015-01-01 00:00:00', 102)) 
and coverage.plan_id in (34 ,
401101 ,
401201 ,
3123002 ,
3123003 ,
3123004 ,
3123006 ,
3123007 ,
3123008 ,
3123009 ,
3123010 ,
3123011 ,
3123014 ,
3123015 ,
3123017 ,
3123018 ,
3123019 ,
3123020 ,
3123030 ,
3123045 ,
3125002 ,
30103002 ,
30103003 ,
30103004 ,
30103005 ,
30103006 ,
30103007 ,
30103008 ,
30103009 ,
1006001 ,
1006002 ,
1003001 ,
3004002 ,
3004005 ,
3004011 ,
3004012 ,
3004014 ,
3004018 ,
302011 ,
302012 ,
302013 ,
3020003 ,
3020006 ,
3020007 ,
3020015 ,
1011004 ,
3112004 ,
3112005 ,
3112007 ,
3112008 ,
3112009 ,
3112010 ,
3112011 ,
3112012 ,
3112017 ,
3112036 ,
3112037 ,
3112038 ,
3112053 ,
3112054 ,
101002 ,
101004 ,
3057001 ,
3057002 ,
3057003 ,
3057004 ,
3057005 ,
3057006 ,
3057010 ,
3057011 ,
3057015 ,
3057017 ,
3057018 ,
3057019 ,
3067016 ,
3067002 ,
3067004 ,
3067005 ,
3067001 ,
3067008 ,
3067009 ,
3067010 ,
3067011 ,
3067012 ,
3067007 ,
3067014 ,
3067015 ,
2005004 ,
2005005 ,
2005999 ,
2007002 ,
2008001 ,
3536002 ,
4033001)
