select
 tdl.TX_ID as CHARGE_TX
,cast(tdl.ORIG_SERVICE_DATE as date) as SERVICE_DATE
,dep.DEPARTMENT_ID
,dep.DEPARTMENT_NAME
,eap.PROC_CODE
,eap.PROC_NAME
,edg1.CURRENT_ICD10_LIST as DX_ONE
,edg1.DX_NAME as DX_ONE_DESC
,edg2.CURRENT_ICD10_LIST as DX_TWO
,edg2.DX_NAME as DX_TWO_DESC
,edg3.CURRENT_ICD10_LIST as DX_THREE
,edg3.DX_NAME as DX_THREE_DESC
,edg4.CURRENT_ICD10_LIST as DX_FOUR
,edg4.DX_NAME as DX_FOUR_DESC
,edg5.CURRENT_ICD10_LIST as DX_FIVE
,edg5.DX_NAME as DX_FIVE_DESC
,edg6.CURRENT_ICD10_LIST as DX_SIX
,edg6.DX_NAME as DX_SIX_DESC
,tdl.AMOUNT

from CLARITY_TDL_TRAN tdl
left join CLARITY_DEP dep on dep.DEPARTMENT_ID = tdl.DEPT_ID
left join CLARITY_EAP eap on eap.PROC_ID = tdl.PROC_ID
left join CLARITY_EDG edg1 on edg1.DX_ID = tdl.DX_ONE_ID
left join CLARITY_EDG edg2 on edg2.DX_ID = tdl.DX_TWO_ID
left join CLARITY_EDG edg3 on edg3.DX_ID = tdl.DX_THREE_ID
left join CLARITY_EDG edg4 on edg4.DX_ID = tdl.DX_FOUR_ID
left join CLARITY_EDG edg5 on edg5.DX_ID = tdl.DX_FIVE_ID
left join CLARITY_EDG edg6 on edg6.DX_ID = tdl.DX_SIX_ID
left join ARPB_TRANSACTIONS arpb_tx on arpb_tx.TX_ID = tdl.TX_ID


where 
tdl.ORIG_SERVICE_DATE >= '6/1/2016'
and tdl.ORIG_SERVICE_DATE <= '6/19/2018'
and tdl.DETAIL_TYPE in (1,10)
and dep.DEPARTMENT_ID in
(
11101255
,11152001
,11101366
,11101264
,11101155
,11101101
,11101217
,11101212
,11101152
,11101105
,11101163
,11101419
,11101363
,11101238
,11101270
,11101141
,11101111
,11101219
,11101179
,11101176
,11101421
,11101106
,11101146
,11103002
,11101137
,11101138
,11101151
,11101157
,11101107
,11101231
,11101239
,11101108
,11101112
,11101181
,11101116
,11101131
,11101144
,11101145
,11101446
,11101109
,11101178
,11101184
,11101224
,11101240
,11101140
,11101182
,11101154
,11101188
,11101383
,11101110
,11101204
,11101130
,11101150
,11101384
,11101113
,11101134
,11101269
,11101320
,11101480
,11101402
,11101177
,11101180
,11101118
,11101153
,11101430
,11101149
,11101148
,11101147

)
and arpb_tx.VOID_DATE is null

order by tdl.TX_ID
/*
'11103103'
,'11103101'
,'11103001'
*/