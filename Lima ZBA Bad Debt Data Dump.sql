SELECT "CLARITY_TDL_TRAN"."ACCOUNT_ID"
	,"CLARITY_TDL_TRAN"."CHARGE_SLIP_NUMBER"
	,"CLARITY_EAP"."PROC_CODE"
	,"CLARITY_EAP"."PROC_NAME"
	,"CLARITY_EAP_Match"."PROC_CODE"
	,"CLARITY_EAP_Match"."PROC_NAME"
	,"CLARITY_TDL_TRAN"."AMOUNT"
	,"CLARITY_TDL_TRAN"."POST_DATE"
	,"CLARITY_TDL_TRAN"."ORIG_SERVICE_DATE"
	,"CLARITY_TDL_TRAN"."SERV_AREA_ID"
	,"CLARITY_TDL_TRAN"."DETAIL_TYPE"
	,"ARPB_TRANSACTIONS"."OUTSTANDING_AMT"
	,"CLARITY_SA"."SERV_AREA_NAME"
	,"CLARITY_TDL_TRAN"."LOC_ID"
	, clarity_tdl_tran.tx_id
	, clarity_tdl_tran.match_trx_id
	, detail_type
FROM (
	(
		(
			"Clarity"."dbo"."CLARITY_TDL_TRAN" "CLARITY_TDL_TRAN" LEFT OUTER JOIN "Clarity"."dbo"."CLARITY_EAP" "CLARITY_EAP" ON "CLARITY_TDL_TRAN"."PROC_ID" = "CLARITY_EAP"."PROC_ID"
			) LEFT OUTER JOIN "Clarity"."dbo"."CLARITY_EAP" "CLARITY_EAP_Match" ON "CLARITY_TDL_TRAN"."MATCH_PROC_ID" = "CLARITY_EAP_Match"."PROC_ID"
		) LEFT OUTER JOIN "Clarity"."dbo"."ARPB_TRANSACTIONS" "ARPB_TRANSACTIONS" ON "CLARITY_TDL_TRAN"."TX_ID" = "ARPB_TRANSACTIONS"."TX_ID"
	)
LEFT OUTER JOIN "Clarity"."dbo"."CLARITY_SA" "CLARITY_SA" ON "CLARITY_TDL_TRAN"."SERV_AREA_ID" = "CLARITY_SA"."SERV_AREA_ID"
WHERE "CLARITY_TDL_TRAN"."SERV_AREA_ID" = 16
	AND "CLARITY_TDL_TRAN"."ORIG_SERVICE_DATE" < {ts '2014-04-01 00:00:00' }
	AND (
		"CLARITY_TDL_TRAN"."POST_DATE" >= {ts '2014-04-01 00:00:00' }
		AND "CLARITY_TDL_TRAN"."POST_DATE" < {ts '2015-10-01 00:00:00' }
		)
/*	AND (
		"CLARITY_EAP_Match"."PROC_CODE" = '5017'
		OR "CLARITY_EAP_Match"."PROC_CODE" = '6002'
		)
	AND (
		"CLARITY_EAP"."PROC_CODE" = '5002'
		OR "CLARITY_EAP"."PROC_CODE" = '5017'
		OR "CLARITY_EAP"."PROC_CODE" = '6002'
		)
*/
	AND "ARPB_TRANSACTIONS"."OUTSTANDING_AMT" = 0
ORDER BY "CLARITY_TDL_TRAN"."LOC_ID"

--31 - Credit Adjustment matched to Debit Adj.
--23 - Debit Adjustment matched to Credit Adj